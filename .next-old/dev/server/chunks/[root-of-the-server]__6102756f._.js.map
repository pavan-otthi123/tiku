{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///Users/muraliotthi/Documents/tiku/lib/storage.ts"],"sourcesContent":["import { list, put, del } from \"@vercel/blob\";\nimport { Photo, PhotosData } from \"./types\";\n\nconst METADATA_KEY = \"photos-metadata.json\";\n\nexport async function getPhotosData(): Promise<PhotosData> {\n  try {\n    // List blobs to find our metadata file\n    const { blobs } = await list({ prefix: METADATA_KEY });\n    const metadataBlob = blobs.find((b) => b.pathname === METADATA_KEY);\n\n    if (!metadataBlob) {\n      return { photos: [] };\n    }\n\n    const response = await fetch(metadataBlob.url);\n    const data: PhotosData = await response.json();\n    return data;\n  } catch {\n    return { photos: [] };\n  }\n}\n\nexport async function savePhotosData(data: PhotosData): Promise<void> {\n  // Delete existing metadata blob if it exists\n  try {\n    const { blobs } = await list({ prefix: METADATA_KEY });\n    const existing = blobs.find((b) => b.pathname === METADATA_KEY);\n    if (existing) {\n      await del(existing.url);\n    }\n  } catch {\n    // Ignore deletion errors\n  }\n\n  await put(METADATA_KEY, JSON.stringify(data), {\n    access: \"public\",\n    contentType: \"application/json\",\n  });\n}\n\nexport async function addPhoto(photo: Photo): Promise<PhotosData> {\n  const data = await getPhotosData();\n  data.photos.push(photo);\n  // Sort by date descending (newest first)\n  data.photos.sort(\n    (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()\n  );\n  await savePhotosData(data);\n  return data;\n}\n\nexport async function deletePhoto(id: string): Promise<PhotosData> {\n  const data = await getPhotosData();\n  const photo = data.photos.find((p) => p.id === id);\n\n  if (photo) {\n    // Delete the image blob\n    try {\n      await del(photo.url);\n    } catch {\n      // Image might already be gone\n    }\n\n    data.photos = data.photos.filter((p) => p.id !== id);\n    await savePhotosData(data);\n  }\n\n  return data;\n}\n\nexport async function uploadImage(\n  file: File,\n  filename: string\n): Promise<string> {\n  const blob = await put(`photos/${filename}`, file, {\n    access: \"public\",\n    contentType: file.type,\n  });\n  return blob.url;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAGA,MAAM,eAAe;AAEd,eAAe;IACpB,IAAI;QACF,uCAAuC;QACvC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAA,gMAAI,EAAC;YAAE,QAAQ;QAAa;QACpD,MAAM,eAAe,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;QAEtD,IAAI,CAAC,cAAc;YACjB,OAAO;gBAAE,QAAQ,EAAE;YAAC;QACtB;QAEA,MAAM,WAAW,MAAM,MAAM,aAAa,GAAG;QAC7C,MAAM,OAAmB,MAAM,SAAS,IAAI;QAC5C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;YAAE,QAAQ,EAAE;QAAC;IACtB;AACF;AAEO,eAAe,eAAe,IAAgB;IACnD,6CAA6C;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAA,gMAAI,EAAC;YAAE,QAAQ;QAAa;QACpD,MAAM,WAAW,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;QAClD,IAAI,UAAU;YACZ,MAAM,IAAA,+LAAG,EAAC,SAAS,GAAG;QACxB;IACF,EAAE,OAAM;IACN,yBAAyB;IAC3B;IAEA,MAAM,IAAA,+LAAG,EAAC,cAAc,KAAK,SAAS,CAAC,OAAO;QAC5C,QAAQ;QACR,aAAa;IACf;AACF;AAEO,eAAe,SAAS,KAAY;IACzC,MAAM,OAAO,MAAM;IACnB,KAAK,MAAM,CAAC,IAAI,CAAC;IACjB,yCAAyC;IACzC,KAAK,MAAM,CAAC,IAAI,CACd,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,IAAI,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,IAAI,EAAE,OAAO;IAEjE,MAAM,eAAe;IACrB,OAAO;AACT;AAEO,eAAe,YAAY,EAAU;IAC1C,MAAM,OAAO,MAAM;IACnB,MAAM,QAAQ,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAE/C,IAAI,OAAO;QACT,wBAAwB;QACxB,IAAI;YACF,MAAM,IAAA,+LAAG,EAAC,MAAM,GAAG;QACrB,EAAE,OAAM;QACN,8BAA8B;QAChC;QAEA,KAAK,MAAM,GAAG,KAAK,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACjD,MAAM,eAAe;IACvB;IAEA,OAAO;AACT;AAEO,eAAe,YACpB,IAAU,EACV,QAAgB;IAEhB,MAAM,OAAO,MAAM,IAAA,+LAAG,EAAC,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM;QACjD,QAAQ;QACR,aAAa,KAAK,IAAI;IACxB;IACA,OAAO,KAAK,GAAG;AACjB"}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file:///Users/muraliotthi/Documents/tiku/app/api/photos/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { getPhotosData, deletePhoto } from \"@/lib/storage\";\n\nexport async function GET() {\n  try {\n    const data = await getPhotosData();\n    return NextResponse.json(data);\n  } catch (error) {\n    console.error(\"Error fetching photos:\", error);\n    return NextResponse.json({ photos: [] }, { status: 500 });\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { id } = await request.json();\n    const data = await deletePhoto(id);\n    return NextResponse.json(data);\n  } catch (error) {\n    console.error(\"Error deleting photo:\", error);\n    return NextResponse.json(\n      { error: \"Failed to delete photo\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,sJAAa;QAChC,OAAO,qKAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,qKAAY,CAAC,IAAI,CAAC;YAAE,QAAQ,EAAE;QAAC,GAAG;YAAE,QAAQ;QAAI;IACzD;AACF;AAEO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,IAAI;QACjC,MAAM,OAAO,MAAM,IAAA,oJAAW,EAAC;QAC/B,OAAO,qKAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,qKAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}